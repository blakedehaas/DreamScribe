<%- include ('../partials/head') %>
<%- include ('../partials/menu') %>

<main>
  <div class="container">
    <br>
    <h1>Edit</h1>
    <br>
        <form action="/updatenote" method="post"> <!-- calls /updatenote -->
   	    <div class="row row-cols-3 row-cols-md-3 g-4"> <!-- use column layout -->
        <% results.forEach(function(entry) { %>
		<div class="col"> 
        <div class="card" style="width: 18rem;">
			<div class="card-body">
				<input name="title" id="note-title" type="text" class="form-control char-limited" aria-label="Text input with dropdown button" value="<%= entry.entry_title %>" maxlength="100">
				<p><span class="char-count">0/100</span></p>
				<textarea class="form-control char-limited" name="text" id="text" rows="3" maxlength="2000"><%= entry.raw_text %></textarea> <!-- text edit area-->
				<p><span class="char-count">0/2000</span></p>
				<a class="btn btn-primary btn-sm" href="/home">Cancel</a>
				<button type="submit" class="btn btn-primary btn-sm">Save</button>
				<input type="hidden" name="id" value="<%= entry.entry_id %>"> <!--  pass entry ID as hidden -->
			</div>
		</div>
		</div>
		</form>
        <% }) %>
        
	<script>
		//character counter
		const inputs = document.querySelectorAll('.char-limited');
		inputs.forEach(input => {
			const charCount = input.nextElementSibling.querySelector('.char-count');
			input.addEventListener('input', () => {
			const count = input.value.length;
			const max = input.maxLength;
			charCount.innerText = `${count}/${max}`;
			});
		});
	</script>
  </div>
</main>

<%- include ('../partials/message') %>
<%- include ('../partials/footer') %>
